# (PART) GIS Basic {.unnumbered}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
```


# Coordinate Reference System

In this chapter, we will work with the `tidyverse` and `sf` packages.
Before starting any exercises, make sure to run the following code.

```{r}

library(tidyverse)
library(sf)

```


## Getting Started

What is Coordinate Reference System (CRS)?
CRS defines how spatial data are projected onto the Earth's surface—essentially, how locations on the curved Earth are represented on a flat map.
Understanding CRS is essential for working with geospatial data accurately.

To get a sense of how CRS works in practice, let's explore a dataset on fish distributions from North Carolina.
This regional dataset contains georeferenced sampling sites using [longitude and latitude](https://www.latlong.net/) coordinates.

We'll start by reading the dataset from the data sub-directory in your R project:

```{r}
df_fish <- read_csv("data/data_fish_nc.csv")
```

This dataset contains the following columns:

```{r cl-table, echo = FALSE}

df_cl_table <- tibble(Column = colnames(df_fish),
                      Description = c("Site name",
                                      "Sampling year",
                                      "Sampling date",
                                      "Longitude",
                                      "Latitude",
                                      "Scientific name",
                                      "Common name",
                                      "Number of fish collected")
                      )

knitr::kable(df_cl_table)
```

Let's take a quick view of the dataframe:

```{r}
print(df_fish)
```

Since this dataframe contains longitude and latitude columns, we can make this data as **georeferenced**.
To do so, we'll need to use functions from `sf` package, which makes the mere numbers of coordinates linked to CRS of your choice.

```{r}
sf_fish <- df_fish %>% 
  st_as_sf(coords = c("lon", "lat"),
           crs = 4326)

print(sf_fish)
```



## Geodetic vs. Projected

Coordinate Reference Systems (CRS) are essential for accurately representing spatial data on the Earth's surface. Broadly, CRS fall into two categories: **geodetic (geographic)** and **projected**. A *geodetic CRS* models the Earth as a 3D ellipsoid and represents locations using angular coordinates — latitude and longitude. These systems are ideal for global positioning and mapping where preserving true geographic coordinates is important. However, because they represent curved surfaces on a spherical model, they are not suitable for accurate distance or area calculations on flat maps. Common examples of **geodetic CRS** include WGS 84 (`EPSG:4326`), which is used by GPS and most global datasets, and NAD83 (`EPSG:4269`), which is widely used in North America.

In contrast, a *projected CRS* transforms geographic coordinates onto a 2D surface using mathematical projections. This allows for accurate measurements of distance, area, or direction in localized regions. Projected systems distort some properties (e.g., shape, area, or scale) but can be tailored for specific mapping needs. Examples of **projected CRS** include UTM zones (e.g., UTM Zone 17N, `EPSG:26917`) and State Plane systems like **North Carolina State Plane (EPSG:32119)**, which are optimized for regional accuracy and are commonly used in government or environmental datasets.

+---------------+----------------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------------+
| CRS Type      | Unit                                                                                   | Advantages                                     | Disadvantages                                         |
+===============+========================================================================================+================================================+=======================================================+
| **Geodetic**  | **Latitude and longitude** on an ellipsoidal model of Earth                            | Global coverage (e.g., GPS)                    | **NOT** for distance, area, or direction calculations |
|               |                                                                                        |                                                |                                                       |
|               |                                                                                        | Standard for data exchange and web maps        | Curved surface not ideal for flat map operations      |
|               |                                                                                        |                                                |                                                       |
|               |                                                                                        | Easy to interpret (lat/lon)                    |                                                       |
+---------------+----------------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------------+
| **Projected** | **X/Y Cartesian coordinates** on a flat surface derived from a projection of the Earth | Enables accurate measurements (distance, area) | Distorts some geographic properties                   |
|               |                                                                                        |                                                |                                                       |
|               |                                                                                        | Optimized for regional analysis                | Limited to specific regions                           |
|               |                                                                                        |                                                |                                                       |
|               |                                                                                        | Supports specialized map projections           | Must choose the right projection for your purpose     |
+---------------+----------------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------------+

: Comparison of geodetic and projected CRS.
